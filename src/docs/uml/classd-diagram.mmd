classDiagram
%% Abstract Classes and Interfaces
    class BusinessPerson {
        <<abstract>>
        -Long id
        -String name
        -String email
        -String password
        -Company company
        -PersonStatus status
        -LocalDateTime createdAt
        -LocalDateTime upatedAt
        +getId()
        +setId()
        +getName()
        +setName()
        +getEmail()
        +setEmail()
        +getPassword()
        +setPassword()
        +getCompany()
        +setCompany()
        +getStatus()
        +setStatus()
        +getCreatedAt()
        +getUpdatedAt()
        +onUpdate()
    }

    class BusinessPersonDTO {
        <<abstract>>
        -Long id
        -String name
        -String email
        -Long businessId
        -String businessName
        -PersonStatus status
        -LocalDateTime createdAt
        -LocalDateTime updatedAt
        +getId()
        +getName()
        +getEmail()
        +getBusinessId()
        +getBusinessName()
        +getStatus()
        +getCreatedAt()
        +getUpdatedAt()
        +Builder
    }

    class Business {
        <<interface>>
        +getName()
        +addEmployee()
        +removeEmployee()
        +getEmployees()
    }

%% Domain Models

    class Employee {
        -double salary
        -Employer manager
        -Date hireDate
        -String position
        +getSalary()
        +setSalary()
        +getManager()
        +setManager()
    }

    class Employer {
        -String department
        -String title
        -List~Employee~ managedEmployees
        +getDepartment()
        +setDepartment()
        +addManagedEmployee()
        +removeManagedEmployee()
        +getTitle()
        +setTitle()
    }

    class Company {
        -Long id
        -String name
        -String address
        -List~BusinessPerson~ employees
        +addEmployee()
        +removeEmployee()
        +getEmployees()
    }

    class Training {
        -Long id
        -String trainingName
        -Date completionDate
        -Date expiryDate
        -BusinessPerson person
        +isExpired()
        +getRemainingDays()
    }

    class Paycheck {
        -Long id
        -double grossPay
        -double taxDeduction
        -double insuranceDeduction
        -double netPay
        -Date payDate
        -Employee employee
        +calculateNetPay()
    }

%% Strategy Pattern
    class TaxCalculationStrategy {
        <<interface>>
        +calculateTax(grossPay)
    }

    class FlatTaxStrategy {
        -double taxRate
        +calculateTax(grossPay)
    }

    class ProgressiveTaxStrategy {
        -Map~Double,Double~ taxBrackets
        +calculateTax(grossPay)
    }

%% Factory Pattern
    class BusinessPersonFactory {
        +createEmployee(name, email, salary)
        +createEmployer(name, email, department)
    }

    class DTOFactory {
        +createDTO(employee)
        +createDTO(employer)
        +createDTO(training)
    }

%% DTOs
    class EmployerDTO {
        -String department
        -String title
        -Integer directReportsCount
        +getPersonType()
        +getDepartment()
        +getTitle()
        +getDIrectReportsCount()
        +builder()
    }

    class EmployeeDTO {
        -Double salary
        -String position
        -LocalDate hireDate
        -Long managerId
        -String managerName
        +getPersonType()
        +getSalary()
        +getPosition()
        +getHireDate()
        +getManagerId()
        +getManagerName()
        +builder()
    }

    class TrainingDTO {
        -Long id
        -String trainingName
        -String description
        -LocalDate completionDate
        -LocalDate expiryDate
        -boolean required
        -boolean expired
        -Long personId
        -String personName
        -LocalDateTime createdAt
        +getId()
        +getTrainingName()
        +getDescription()
        +getCompletionDate()
        +getExpiryDate()
        +isRequired()
        +isExpired()
        +getPersonId()
        +getCreatedAt()
        +builder()
    }

    class ErrorResponse {
        <<record>>
        -LocalDateTime timeStamp
        -int status
        -String error
        -String message
    }

%% Services
    class PayrollService {
        <<service>>
        -TaxCalculationStrategy taxStrategy
        +calculatePayroll(employee)
        +distributeBonuses(employees)
        +setTaxStrategy(strategy)
    }

    class EmployeeService {
        <<service>>
        +createEmployee(CreateEmployeeRequest)
        +getEmployee(Long)
        +getAllEmployees()
        +updateEmployee(Long, UpdateEmployeeRequest)
        +deleteEmployee(Long)
        +getEmployeesByBusiness(Long)
        +getEmployeesByManager(Long)
        +assignManager(Long, Long)
        +removeManager(Long)
        +updateSalary(Long, Double)
        +giveBonus(Long, Double)
        +updatePosition(Long, String)
        +updateStatus(Long, String)
        +searchByName(String)
        +getEmployeesByPosition(String)
        +getEmployeesHiredAfter(String)
    }

    class EmployerService {
        <<service>>
        +createEmployer(CreateEmployerRequest)
        +getEmployer(Long)
        +getAllEmployers()
        +updateEmployer(Long, UpdateEmployerRequest)
        +deleteEmployer(Long)
        +getEmployersByBusiness(Long)
        +getEmployersByDepartment(String)
        +addManagedEmployee(Long, Long)
        +removeManagedEmployee(Long, Long)
        +getDirectReports(Long)
        +getDirectReportsCount(Long)
        +updateDepartment(Long, String)
        +updateTitle(Long, String)
        +updateStatus(Long, String)
        +searchByName(String)
        +getEmployersByTitle(String)
    }

    class TrainingService {
        <<service>>
        +addTraining(training)
        +checkExpiredTrainings(person)
        +getTrainingsByPerson(personId)
    }

    class BusinessService {
        <<service>>
        +createBusiness(businessDTO)
        +updateBusiness(id, businessDTO)
        +deleteBusiness(id)
        +getBusiness(id)
    }

%% Controllers
    class EmployeeController {
        <<RestController>>
        -EmployeeService employeeService
        +createEmployee(CreateEmployeeRequest)
        +getEmployee(Long)
        +getAllEmployees()
        +updateEmployee(Long, UpdateEmployeeRequest)
        +deleteEmployee(Long)
        +getEmployeesByBusiness(Long)
        +getEmployeesByManager(Long)
        +assignManager(Long, Long)
        +updateSalary(Long, Double)
        +giveBonus(Long, Double)
    }

    class EmployerController {
        <<RestController>>
        -EmployerService employerService
        +createEmployer(CreateEmployerRequest)
        +getEmployer(Long)
        +getAllEmployers()
        +updateEmployer(Long, UpdateEmployerRequest)
        +deleteEmployer(Long)
        +getEmployersByBusiness(Long)
        +getEmployersByDepartment(String)
        +getDirectReports(Long)
    }

    class PayrollController {
        <<RestController>>
        -PayrollService payrollService
        +calculatePayroll(employeeId)
        +distributeBonuses(businessId)
    }

    class TrainingController {
        <<RestController>>
        -TrainingService trainingService
        +addTraining(trainingDTO)
        +getTrainingsByPerson(personId)
        +checkExpiredTrainings(personId)
    }

    class BusinessController {
        <<RestController>>
        -BusinessService businessService
        +createBusiness(businessDTO)
        +updateBusiness(id, businessDTO)
        +deleteBusiness(id)
        +getBusiness(id)
    }

%% Repositories
    class EmployeeRepository {
        <<Repository>>
        +save(employee)
        +findById(id)
        +findAll()
        +delete(employee)
        +findByBusinessId(Long)
        +findByManagerId(Long)
        +findByEmail(String)
        +findByPosition(String)
        +findByStatus(String)
        +findByNameContainingIgnoreCase(String)
        +findBySalaryBetween(Double, Double)
        +findByHireDateAfter(LocalDate)
    }

    class EmployerRepository {
        <<Repository>>
        +save(employer)
        +findById(id)
        +findAll()
        +delete(employer)
        +findByBusinessId(Long)
        +findByDepartment(String)
        +findByEmail(String)
        +findByTitle(String)
        +findByStatus(String)
        +findByNameContainingIgnoreCase(String)
    }

    class BusinessRepository {
        <<Repository>>
        +save(business)
        +findById(id)
        +findAll()
        +delete(business)
    }

    class TrainingRepository {
        <<Repository>>
        +save(training)
        +findByPersonId(personId)
        +findExpiredTrainings()
    }

%% Exceptions
    class GlobalExceptionHandler {
        <<RestControllerAdvice>>
        +handleEmployerNotFoundException(EmployerNotFoundException)
        +handleEmployeeNotFoundException(EmployeeNotFoundException)
        +handleBusinessNotFoundException(BusinessNotFoundException)
        +handleInvalidBusinessException(InvalidBusinessException)
        +handleIllegalArgumentException(IllegalArgumentException)
        +handleException(Exception)
    }

    class EmployerNotFoundException {
        <<Exception>>
        +EmployerNotFoundException(employerId)
        +EmployerNotFoundException(message)
    }

    class EmployeeNotFoundException {
        <<Exception>>
        +EmployeeNotFoundException(employeeId)
        +EmployeeNotFoundException(message)
    }

    class BusinessNotFoundException {
        <<Exception>>
        +BusinessNotFoundException(id)
        +BusinessNotFoundException(message)
    }

    class InvalidBusinessException {
        <<Exception>>
        +InvalidBusinessException(message)
        +InvalidBusinessException(message, cause)
    }

%% Relationships - Inheritance
    BusinessPerson <|-- Employee
    BusinessPerson <|-- Employer
    BusinessPersonDTO <|-- EmployeeDTO
    BusinessPersonDTO <|-- EmployerDTO
    Business <|.. Company
    TaxCalculationStrategy <|.. FlatTaxStrategy
    TaxCalculationStrategy <|.. ProgressiveTaxStrategy
    RuntimeException <|.. EmployerNotFoundException
    RuntimeException <|.. EmployeeNotFoundException
    RuntimeException <|.. BusinessNotFoundException
    RuntimeException <|.. InvalidBusinessException

%% Relationships - Associations
    Employee --> Employer : managed by
    Company "1" --> "*" BusinessPerson : employs
    Training "*" --> "1" BusinessPerson : completed by
    Paycheck "*" --> "1" Employee : paid to
    GlobalExceptionHandler --> EmployerNotFoundException : handled by
    GlobalExceptionHandler --> EmployeeNotFoundException : handled by
    GlobalExceptionHandler --> BusinessNotFoundException : handled by
    GlobalExceptionHandler --> InvalidBusinessException : handled by

%% Services use Repositories
    EmployeeService --> EmployeeRepository
    EmployeeService --> EmployerRepository
    EmployeeService --> BusinessRepository
    EmployerService --> EmployerRepository
    EmployerService --> EmployeeRepository
    EmployerService --> BusinessRepository
    BusinessService --> BusinessRepository
    TrainingService --> TrainingRepository

%% Services use Strategies
    PayrollService --> TaxCalculationStrategy

%% Controllers use Services
    EmployeeController --> EmployeeService
    EmployerController --> EmployerService
    PayrollController --> PayrollService
    TrainingController --> TrainingService
    BusinessController --> BusinessService

%% Factory creates BusinessPersons
    BusinessPersonFactory ..> Employee : creates
    BusinessPersonFactory ..> Employer : creates
    DTOFactory ..> EmployeeDTO : creates
    DTOFactory ..> EmployerDTO : creates